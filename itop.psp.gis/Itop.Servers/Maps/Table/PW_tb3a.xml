<?xml version='1.0' encoding='UTF-8' ?>
<sqlMap namespace='PW_tb3a' xmlns='http://ibatis.apache.org/mapping' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'>
<alias>
	<typeAlias alias='PW_tb3a' assembly='Itop.Domain.PWTable.dll' type='Itop.Domain.PWTable.PW_tb3a' />
</alias>
	<resultMaps>
		<resultMap id='PW_tb3aResult' class='PW_tb3a'>
			<result property='UID' column='UID' />
			<result property='PQName' column='PQName' />
			<result property='PQtype' column='PQtype' />
			<result property='SubName' column='SubName' />
			<result property='LineName' column='LineName' />
			<result property='LineType' column='LineType' />
			<result property='LineLength' column='LineLength' />
			<result property='Num1' column='Num1' />
			<result property='Num2' column='Num2' />
			<result property='Num3' column='Num3' />
			<result property='Num4' column='Num4' />
			<result property='Num5' column='Num5' />
			<result property='Num6' column='Num6' />
			<result property='Num7' column='Num7' />
			<result property='Num8' column='Num8' />
			<result property='LineSX' column='LineSX' />
			<result property='KBS' column='KBS' />
			<result property='KG' column='KG' />
			<result property='JXMS' column='JXMS' />
			<result property='LLXMC' column='LLXMC' />
			<result property='MaxFH' column='MaxFH' />
			<result property='SafeFH' column='SafeFH' />
			<result property='FZL' column='FZL' />
			<result property='col1' column='col1' />
			<result property='col2' column='col2' />
			<result property='col3' column='col3' />
      <result property='WG1' column='WG1' />
      <result property='WG2' column='WG2' />
      <result property='WG3' column='WG3' />
      <result property='WG4' column='WG4' />
		</resultMap>
	</resultMaps>
<statements>
	<insert id='InsertPW_tb3a' parameterClass='PW_tb3a'>
    INSERT INTO PW_tb3a		(
    "UID",
    "PQName",
    "PQtype",
    "SubName",
    "LineName",
    "LineType",
    "LineLength",
    "Num1",
    "Num2",
    "Num3",
    "Num4",
    "Num5",
    "Num6",
    "Num7",
    "Num8",
    "LineSX",
    "KBS",
    "KG",
    "JXMS",
    "LLXMC",
    "MaxFH",
    "SafeFH",
    "FZL",
    "col1",
    "col2",
    "col3",
    "WG1",
    "WG2",
    "WG3",
    "WG4"
    )
    VALUES
    (
    #UID#,
    #PQName#,
    #PQtype#,
    #SubName#,
    #LineName#,
    #LineType#,
    #LineLength#,
    #Num1#,
    #Num2#,
    #Num3#,
    #Num4#,
    #Num5#,
    #Num6#,
    #Num7#,
    #Num8#,
    #LineSX#,
    #KBS#,
    #KG#,
    #JXMS#,
    #LLXMC#,
    #MaxFH#,
    #SafeFH#,
    #FZL#,
    #col1#,
    #col2#,
    #col3#,
    #WG1#,
    #WG2#,
    #WG3#,
    #WG4#
    )
  </insert>
	<delete id='DeletePW_tb3a' parameterClass='PW_tb3a'>
		DELETE FROM PW_tb3a
		WHERE
			UID = #UID#
	</delete>
	<update id='UpdatePW_tb3a' parameterClass='PW_tb3a'>
    UPDATE PW_tb3a
    SET
    "PQName" = #PQName#,
    "PQtype" = #PQtype#,
    "SubName" = #SubName#,
    "LineName" = #LineName#,
    "LineType" = #LineType#,
    "LineLength" = #LineLength#,
    "Num1" = #Num1#,
    "Num2" = #Num2#,
    "Num3" = #Num3#,
    "Num4" = #Num4#,
    "Num5" = #Num5#,
    "Num6" = #Num6#,
    "Num7" = #Num7#,
    "Num8" = #Num8#,
    "LineSX" = #LineSX#,
    "KBS" = #KBS#,
    "KG" = #KG#,
    "JXMS" = #JXMS#,
    "LLXMC" = #LLXMC#,
    "MaxFH" = #MaxFH#,
    "SafeFH" = #SafeFH#,
    "FZL" = #FZL#,
    "col1" = #col1#,
    "col2" = #col2#,
    "col3" = #col3#,
    "WG1" = #WG1#,
    "WG2" = #WG2#,
    "WG3" = #WG3#,
    "WG4" = #WG4#
    WHERE
    UID = #UID#
  </update>
	<select id='SelectPW_tb3aList' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    SELECT
    "UID",
    "PQName",
    "PQtype",
    "SubName",
    "LineName",
    "LineType",
    "LineLength",
    "Num1",
    "Num2",
    "Num3",
    "Num4",
    "Num5",
    "Num6",
    "Num7",
    "Num8",
    "LineSX",
    "KBS",
    "KG",
    "JXMS",
    "LLXMC",
    "MaxFH",
    "SafeFH",
    "FZL",
    "col1",
    "col2",
    "col3",
    "WG1",
    "WG2",
    "WG3",
    "WG4"
    FROM PW_tb3a where col2= #col2# order by PQName,PQtype,SubName,LineName
  </select>
  <select id='SelectPW_tb3aListName' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    SELECT
    "UID",
    "PQName",
    "PQtype",
    "SubName",
    "LineName",
    "LineType",
    "LineLength",
    "Num1",
    "Num2",
    "Num3",
    "Num4",
    "Num5",
    "Num6",
    "Num7",
    "Num8",
    "LineSX",
    "KBS",
    "KG",
    "JXMS",
    "LLXMC",
    "MaxFH",
    "SafeFH",
    "FZL",
    "col1",
    "col2",
    "col3",
    "WG1",
    "WG2",
    "WG3",
    "WG4"
    FROM PW_tb3a where col2= #col2# order by LineName
  </select>
	<select id='SelectPW_tb3aByKey' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    SELECT
    "UID",
    "PQName",
    "PQtype",
    "SubName",
    "LineName",
    "LineType",
    "LineLength",
    "Num1",
    "Num2",
    "Num3",
    "Num4",
    "Num5",
    "Num6",
    "Num7",
    "Num8",
    "LineSX",
    "KBS",
    "KG",
    "JXMS",
    "LLXMC",
    "MaxFH",
    "SafeFH",
    "FZL",
    "col1",
    "col2",
    "col3",
    "WG1",
    "WG2",
    "WG3",
    "WG4"
    FROM PW_tb3a
    WHERE
    UID = #UID#
  </select>
  <select id='SelectPW_tb3aByLineName' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    SELECT
    "UID",
    "PQName",
    "PQtype",
    "SubName",
    "LineName",
    "LineType",
    "LineLength",
    "Num1",
    "Num2",
    "Num3",
    "Num4",
    "Num5",
    "Num6",
    "Num7",
    "Num8",
    "LineSX",
    "KBS",
    "KG",
    "JXMS",
    "LLXMC",
    "MaxFH",
    "SafeFH",
    "FZL",
    "col1",
    "col2",
    "col3",
    "WG1",
    "WG2",
    "WG3",
    "WG4"
    FROM PW_tb3a
    WHERE
    LineName = #LineName# and col2= #col2#
  </select>
  <select id='SelectPW_tb3aByLLXName' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    SELECT
    "UID",
    "PQName",
    "PQtype",
    "SubName",
    "LineName",
    "LineType",
    "LineLength",
    "Num1",
    "Num2",
    "Num3",
    "Num4",
    "Num5",
    "Num6",
    "Num7",
    "Num8",
    "LineSX",
    "KBS",
    "KG",
    "JXMS",
    "LLXMC",
    "MaxFH",
    "SafeFH",
    "FZL",
    "col1",
    "col2",
    "col3",
    "WG1",
    "WG2",
    "WG3",
    "WG4"
    FROM PW_tb3a
    WHERE
    LLXMC like '%$LineName$%' and col2= #col2#
  </select>
  <select id='SelectPW_tb3aBy321' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>

    SELECT
    ' ' as "UID",
    a.PQName,a.PQtype,
    ' '  as "SubName",
    ' ' as "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
    0.0 AS Num1,
    SUM(Num1 + Num2) AS Num2, SUM(Num3) AS Num3,
    SUM(Num4) AS Num4, sum(Num5) AS Num5, SUM(Num6) AS Num6,
    sum(Num7) AS Num7, SUM(Num8) AS Num8,
    ' ' as "LineSX",
    sum(case when LineSX='专用' then 1 else 0 end) as KBS,
    convert(decimal(15,2),  COUNT(LineName)) AS KG,
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
    ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
    FROM PW_tb3a a where col2= #col2#
    GROUP BY PQName,PQtype
  </select>
  <select id='SelectPW_tb3aBy322' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    SELECT
    ' ' as "UID",
    PQName,PQtype,
    (select top 1 LineName from PW_tb3a where PQName=a.PQName order by LineLength desc ) as "SubName",
    (select top 1 LineName from PW_tb3a where PQName=a.PQName order by LineLength ) as "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
    convert(decimal(15,0), count(LineName)) AS Num1, SUM(LineLength) AS Num2, max(LineLength) AS Num3,
    min(LineLength) AS Num4, 0 AS Num5, convert(decimal(15,2),avg(LineLength)) AS Num6,
    0 AS Num7, 0.0 AS Num8,
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
    ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
    FROM PW_tb3a  a where LineSX in ( $col1$ ) and col2= #col2# 
    GROUP BY PQName,PQtype
  </select>
  <select id='SelectPW_tb3aBy323' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
       SELECT
    ' ' as "UID",
    PQName,PQtype,
    ' ' as "SubName",
    ' ' as "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
   convert(decimal(15,0), sum(case  when LineLength<2 then 1 else 0 end)) as "Num1",
   convert(decimal(15,0), sum(case  when (LineLength>2 and LineLength<=3) then 1 else 0 end)) as "Num2",
   convert(decimal(15,0), sum(case  when (LineLength>3 and LineLength<=4) then 1 else 0 end)) as "Num3",    
	 convert(decimal(15,0), sum(case  when (LineLength>4 and LineLength<=5) then 1 else 0 end)) as "Num4",
	  sum(case  when (LineLength>5 and LineLength<=6) then 1 else 0 end) as "Num5",
	 convert(decimal(15,0), sum(case  when (LineLength>6 and LineLength<=7) then 1 else 0 end)) as "Num6",
	  sum(case  when (LineLength>7 and LineLength<=8) then 1 else 0 end) as "Num7",
	 convert(decimal(15,0), sum(case  when LineLength>8 then 1 else 0 end)) as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
    ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  a where LineSX in ( $col1$ ) and col2= #col2# 
    GROUP BY PQName,PQtype
      ]]>
  </select>
  <select id='SelectPW_tb3aBy324' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    SELECT
    ' ' as "UID",
    PQName,PQtype,
    SubName,
    LineName,
    ' ' as "LineType",
    LineLength,
    0.0 AS Num1, 0.0 as Num2, 0.0 as Num3,
    Num4, 0 AS Num5, 0.0 Num6,
    0 AS Num7, 0.0 AS Num8,
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
    ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
    FROM PW_tb3a a,PW_tb3c c where a.PQtype=c.col1 and a.col2= #col3# and c.col4= #col3# 
    and  LineSX in ( $col1$ ) and PQtype in ( $col2$ ) and a.LineLength>convert(decimal(15,2),c.col2)
    order BY PQName,PQtype
  </select>
  <select id='SelectPW_tb3aBy326' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
    SELECT
    ' ' as "UID",
    PQName,PQtype,
    ' ' as "SubName",
    ' ' as "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
   convert(decimal(15,0), sum(case  when b.col8=50 then 1 else 0 end)) as "Num1",
   convert(decimal(15,0), sum(case  when b.col8=70 then 1 else 0 end)) as "Num2",
   convert(decimal(15,0), sum(case  when b.col8=95 then 1 else 0 end)) as "Num3",
   convert(decimal(15,0), sum(case  when b.col8=120 then 1 else 0 end)) as "Num4",
   convert(int, sum(case  when b.col8=150 then 1 else 0 end)) as "Num5",
   convert(decimal(15,0), sum(case  when b.col8>=185 then 1 else 0 end)) as "Num6",
   0 as "Num7",
   0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
    ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  a ,PW_tb3b  b where  a.UID=b.col7 
     and  LineSX in ( $col1$ ) and a.col2= #col2# 
    GROUP BY PQName,PQtype
      ]]>
  </select>
  <select id='SelectPW_tb3aBy327' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
    SELECT
    ' ' as "UID",
    PQName, PQtype,
    SubName,
    LineName,
    b.col3 as "LineType",
    LineLength,
   0.0 as "Num1",
   0.0 as "Num2",
   0.0 as "Num3",
   Num4,
   0 as "Num5",
   0.0 as "Num6",
   0 as "Num7",
   0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
     ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  a ,PW_tb3b  b,PW_tb3c  c where  a.UID=b.col7  and  LineSX in ( $col1$ ) 
   and a.PQtype=c.col1 and  b.col8<c.col3 and a.col2= #col2# and c.col4= #col2#
    order  BY PQName,PQtype
      ]]>
  </select>
  <select id='SelectPW_tb3aBy328' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>

    SELECT
    ' ' as "UID",
    a.PQName,' ' as PQtype,
    ' '  as "SubName",
    ' ' as "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
    SUM(Num1 + Num2) AS Num1, sum(Num2) as Num2, SUM(Num3) AS Num3,
    SUM(Num4) AS Num4, convert(int,sum(Num5)) AS Num5, SUM(Num6) AS Num6,
    convert(int,sum(Num7)) AS Num7, SUM(Num8) AS Num8,
    ' ' as "LineSX",
    count(LineName) as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    convert(decimal(15,0),sum(Num5+Num7)) as "MaxFH",
    sum(Num6+Num8) as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
    ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
    FROM PW_tb3a a where  LineSX in ( $col1$ ) and col2= #col2#
    GROUP BY PQName
  </select>
  <select id='SelectPW_tb3aBy329' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
       SELECT
    ' ' as "UID",
    PQName,' ' as PQtype,
    ' ' as "SubName",
    ' ' as "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
   convert(decimal(15,0), sum(case  when (Num6+Num8)<0.2 then 1 else 0 end)) as "Num1",
   convert(decimal(15,0), sum(case  when (Num6+Num8>0.2 and Num6+Num8<=0.8) then 1 else 0 end)) as "Num2",
   convert(decimal(15,0), sum(case  when (Num6+Num8>0.8 and Num6+Num8<=1.2) then 1 else 0 end)) as "Num3",    
	 convert(decimal(15,0), sum(case  when (Num6+Num8>1.2 and Num6+Num8<=2) then 1 else 0 end)) as "Num4",
	 0 as "Num5",
	 convert(decimal(15,0), sum(case  when (Num6+Num8>2) then 1 else 0 end)) as "Num6",
	 0 as "Num7",
	 0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
     ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  a where LineSX in ( $col1$ ) and col2= #col2#
    GROUP BY PQName
      ]]>
  </select>
  <select id='SelectPW_tb3aBy3210' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
       SELECT
    ' ' as "UID",
    PQName,' ' as PQtype,
    ' ' as "SubName",
    LineName,
    ' ' as "LineType",
    0.0 as "LineLength",
   0.0 as "Num1",
   0.0 as "Num2",
   0.0 as "Num3",    
	 0.0 as "Num4",
	 convert(int, sum(Num5+Num7)) as "Num5",
	 convert(decimal(15,0), sum(Num6+Num8)) as "Num6",
	 0 as "Num7",
	 0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
      ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  a where LineSX in ( $col1$ ) and (Num6+Num8)>1.2 and col2= #col2#
    GROUP BY PQName,LineName order by PQName,LineName
      ]]>
  </select>
  <select id='SelectPW_tb3aBy3211' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
        SELECT
    ' ' as "UID",
    PQName,' ' as PQtype,
    ' ' as "SubName",
   ' ' as  "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
   convert(decimal(15,0), sum(case  when (JXMS)='单联络' then 1 else 0 end)) as "Num1",
   0.0 as "Num2",
   0.0 as "Num3",    
	 0.0 as "Num4",
	 0 as "Num5",
	 0.0 as "Num6",
	 0 as "Num7",
	 0.0 as "Num8",
    ' ' as "LineSX",
    sum(KBS) as KBS,
    sum(KG) as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
     ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  where LineSX in ( $col1$ ) and col2= #col2#
    GROUP BY PQName
      ]]>
  </select>
  <select id='SelectPW_tb3aBy3212' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
        SELECT
    ' ' as "UID",
    PQName,' ' as PQtype,
    ' ' as "SubName",
   ' ' as  "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
   convert(decimal(15,0), sum(case  when (JXMS)='直馈线' then 1 else 0 end)) as "Num1",
   convert(decimal(15,0), sum(case  when (JXMS)='单联络' then 1 else 0 end)) as "Num2",
   convert(decimal(15,0), sum(case  when (JXMS)='两联络' then 1 else 0 end)) as "Num3",
	 convert(decimal(15,0), sum(case  when (JXMS)='多联络' then 1 else 0 end)) as "Num4",
	 0 as "Num5",
	 0.0 as "Num6",
	 0 as "Num7",
	 0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
     ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  where LineSX in ( $col1$ ) and col2= #col2#
    GROUP BY PQName
      ]]>
  </select>
  <select id='SelectPW_tb3aBy332' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
         SELECT
    ' ' as "UID",
    PQName,' ' as PQtype,
    SubName,
    LineName,
    ' ' as "LineType",
    0.0 as "LineLength",
   convert(decimal(15,0), sum(case  when (col5)='架空' and col6='主干线' then col4 else 0 end)) as "Num1",
   convert(decimal(15,0), sum(case  when (col5)='架空' and (col6='次干线' or col6='分支线') then col4 else 0 end)) as "Num2",
   convert(decimal(15,0), sum(case  when (col5)='电缆' and col6='主干线' then col4 else 0 end)) as "Num3",
   convert(decimal(15,0), sum(case  when (col5)='电缆' and (col6='次干线' or col6='分支线') then col4 else 0 end)) as "Num4",
	 sum(Num5) as "Num5",
	 sum(Num6) as "Num6",
	 sum(Num7) as "Num7",
	 sum(Num8) as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    JXMS = dbo.f_strUnite(b.col7,'架空','主干线',''),
    LLXMC=dbo.f_strUnite(b.col7,'架空','次干线','分支线'),
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    col1=dbo.f_strUnite(b.col7,'电缆','主干线',''),
    col2=dbo.f_strUnite(b.col7,'电缆','次干线','分支线'),
     ' ' as "col3",
    sum(WG1) as "WG1",
    sum(WG2) as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a a,PW_tb3b b  where b.col7=a.UID  and LineSX in ( $col1$ ) and a.col2= #col2# 
    group BY PQName, subname,linename,b.col7

      ]]>
  </select>
  <select id='SelectPW_tb3aBy333' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
       SELECT
    ' ' as "UID",
    PQName,' ' as "PQtype",
    ' ' as "SubName",
    ' ' as "LineName",
    ' ' as "LineType",
    0.0 as "LineLength",
   convert(decimal(15,0), sum(case  when FZL<30.00 then 1 else 0 end)) as "Num1",
   convert(decimal(15,0), sum(case  when (FZL>=30.00 and FZL<=40.00) then 1 else 0 end)) as "Num2",
   convert(decimal(15,0), sum(case  when (FZL>40.00 and FZL<=50.00) then 1 else 0 end)) as "Num3",    
	 convert(decimal(15,0), sum(case  when (FZL>50.00 and FZL<=60.00) then 1 else 0 end)) as "Num4",
	 convert(int, sum(case  when (FZL>60.00 and FZL<=70.00) then 1 else 0 end)) as "Num5",
	 convert(decimal(15,0), sum(case  when (FZL>70.00 and FZL<=80.00) then 1 else 0 end)) as "Num6",
	 convert(int, sum(case  when (FZL>80.00 and FZL<=90.00) then 1 else 0 end)) as "Num7",
	 convert(decimal(15,0), sum(case  when FZL>90.00 then 1 else 0 end)) as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    ' ' as "LLXMC",
    0.0 as "MaxFH",
    0.0 as "SafeFH",
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
    ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  a where LineSX in ( $col1$ ) and col2= #col2# 
    GROUP BY PQName
      ]]>
  </select>
  <select id='SelectPW_tb3aBy334' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
       SELECT
    ' ' as "UID",
    PQName,' ' as PQtype,
    SubName,
    LineName,
    ' ' as "LineType",
    0.0 as "LineLength",
   0.0 "Num1",
   0.0 as "Num2",
   0.0 as "Num3",    
	 0.0 as "Num4",
	 0 as "Num5",
	 0.0 as "Num6",
	 0 as "Num7",
	 0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    JXMS,
    ' ' as "LLXMC",
    MaxFH,
    SafeFH,
    FZL,
    ' ' as "col1",
    ' ' as "col2",
     ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a  where LineSX in ( $col1$ ) and col2= #col2# and ((FZL>100.00 and JXMS='直馈线') or (FZL>50.00 and JXMS='单联络') or (FZL>67.00 and JXMS='两联络'))
  order by PQName,SubName,LineName
      ]]>
  </select>
  <select id='SelectPW_tb3aBy341' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
        SELECT
    ' ' as "UID",
    PQName,' ' as PQtype,
    SubName,
    LineName,
    ' ' as "LineType",
    0.0 as "LineLength",
   0.0 "Num1",
   0.0 as "Num2",
   0.0 as "Num3",    
	 0.0 as "Num4",
	 0 as "Num5",
	 0.0 as "Num6",
	 0 as "Num7",
	 0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    LLXMC,
    MaxFH,
    SafeFH,
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
     ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a where LineSX in ( $col1$ ) and col2= #col2#
  order by PQName,SubName,LineName
      ]]>
  </select>
  <select id='SelectPW_tb3aBy342' resultMap='PW_tb3aResult' parameterClass='PW_tb3a'>
    <![CDATA[
            SELECT
    s.L15 as "UID",
    s.L4 as "PQName",
    ' ' as PQtype,
    SubName,
    LineName,
    ' ' as "LineType",
    0.0 as "LineLength",
      convert(decimal(15,2),isnull(s.L2,0.0)) as "Num1",
   convert(decimal(15,2),isnull(s.L10,0.0)) as "Num2",
   convert(decimal(15,2),isnull(s.L9,0.0)) as "Num3",    
	 0.0 as "Num4",
	 0 as "Num5",
	 0.0 as "Num6",
	 0 as "Num7",
	 0.0 as "Num8",
    ' ' as "LineSX",
    0 as KBS,
    0 as "KG",
    ' ' as "JXMS",
    LLXMC,
    MaxFH,
    SafeFH,
    0.0 as "FZL",
    ' ' as "col1",
    ' ' as "col2",
     ' ' as "col3",
    0.0 as "WG1",
    0.0 as "WG2",
    0.0 as "WG3",
    0.0 as "WG4"
     FROM PW_tb3a a,PSP_Substation_Info s where a.col2=s.AreaID and a.SubName=s.Title and  a.LineSX in ( $col1$ ) and a.col2= #col2# 
  order by SubName
      ]]>
  </select>
</statements>
</sqlMap>